{% extends "base.html" %}

{% block content %}
<div class="flan-detail-container">
    <h1>{{ flan.nom }}</h1>
    <p>{{ flan.description or "Un délicieux flan maison" }}</p>
    <p>Prix : {{ "%.2f"|format(flan.prix) }} €</p>

    <div class="evaluations-section">
    {%  print "evaluation" %}
        {% for evaluation in flan.evaluations if evaluation.statut.value == 'Validé' %}
        <div class="evaluation-card">
            <div class="evaluation-left">
                <h3>Évaluation par {{ evaluation.user.pseudo }}</h3>
                <div class="evaluation-notes">
                    <p>Visuel : {{ evaluation.visuel }}/5</p>
                    <p>Texture : {{ evaluation.texture }}/5</p>
                    <p>Pâte : {{ evaluation.pate }}/5</p>
                    <p>Goût : {{ evaluation.gout }}/5</p>
                </div>
                <div class="evaluation-moyenne">
                    <strong>Moyenne : {{ "%.1f"|format(evaluation.moyenne) }}/5</strong>
                </div>
                <div class="evaluation-comment">
                    <p>{{ evaluation.description or "Aucun commentaire" }}</p>
                </div>
            </div>
            <div class="evaluation-right">
                {% if evaluation.photo %}
                <img src="{{ url_for('static', filename='uploads/' + evaluation.photo) }}" alt="Photo de l'évaluation" class="evaluation-photo">
                {% else %}
                <p>Aucune photo disponible</p>
                {% endif %}
            </div>
        </div>
        {% else %}
        <p>Aucune évaluation validée pour ce flan.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}
